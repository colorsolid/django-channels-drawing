{% extends 'labs/labs.html' %}

{% load staticfiles %}

{% load tz %}

{% block subtitle %} > Drawing Lobby{% endblock %}

{% block head_extend %}
  <link rel="stylesheet" type="text/css" href="{% static 'css/lobby.css' %}">
  <link rel="stylesheet" type="text/css" href="{% static 'css/header.css' %}">
{% endblock %}

{% block content_labs %}
  <div class="row">
    <div class="col-xl-4 col-lg-3 col-md-2 col-xs-0"></div>
    <div class="col-xl-4 col-lg-6 col-md-8 col-xs-12">
      <h3 class="text-light">Create or join a drawing room</h3>
      <form action="{% url 'lobby' %}" method="POST" class="post-form">{% csrf_token %}
        {% for form in forms %}
          {% for hidden_field in form.hidden_fields %}
            {{ hidden_field.errors }}
            {{ hidden_field }}
          {% endfor %}

          <div class="input-group mb-3">
            {% for field in form.visible_fields %}
              {{ field.errors }}
              <div class="input-group-prepend">
                <span class="input-group-text">{{ field.label_tag }}</span>
              </div>
              <input type="text" name="{{ field.name }}" id="{{ field.id_for_label }}" class="form-control {{ field.name }}"
               value="{{ field.initial }}"
               maxlength="{{ field.field.max_length }}" aria-describedby="nickname-descriptor"
               {% if form.name.field.required %}required{% endif %}>
               {% if field.name == 'nickname' %}
                 <div class="input-group-append">
                   <span id="hash-display" class="input-group-text">#{{ user_id|slice:'0:4' }}</span>
                 </div>
               {% endif %}
               <div class="input-group-append">
                 <a role="button" class="btn btn-primary" id="btn-randomize-{{ field.name }}" data-toggle="tooltip" data-placement="top" title="Randomize name">&#127922;</a>
               </div>
            {% endfor %}
          </div>
        {% endfor %}
        <button class="btn btn-block btn-primary" type="submit">Create or join room</button>
      </form>
    </div>
    <div class="col-xl-4 col-lg-4 col-md-2 col-xs-0"></div>
  </div>
  <div class="row">
    <div class="col-xl-4 col-sm-0"></div>
    <div class="col-xl-4 col-sm-12">
      {# <button id="room-submit" class="btn btn-block btn-primary">Create room</button> #}
    </div>
    <div class="col-sm-4 col-sm-0"></div>
  </div>
  <div class="row">
    <div class="col-xl-1"></div>
    <div class="col-xl-10 border-top border-dark mt-3">
      <h3 class="mt-1 text-light">Recently edited rooms</h3>
      <div id="room-browse">
        <div class="row">
          <div class="col-xl-1 col-m-0"></div>
          {% for room in rooms %}
            {% if forloop.counter|divisibleby:6 %}
              <div class="col-xl-1 col-m-0"></div>
            {% endif %}
            <div class="col-xl-2 col-m-12">
              <a class="btn btn-primary btn-small w-100 overflow-hidden mb-1" href="/draw/{{ room.room_name }}">
                <h4>
                  {{ room.room_name }}
                </h4>
                Created by: <br>{{ room.creator_nickname }} <div class="mt-2 badge badge-dark">#{{ room.creator_hash|slice:'0:4' }}</div>
              </a>
            </div>
            {% if forloop.counter|divisibleby:5 %}
              <div class="col-xl-1"></div>
            {% endif %}
          {% empty %}
            <div class="col-xl-10"><h4>No rooms found</h4></div>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
{% endblock %}

{% block scripts %}
  <script type="text/javascript">
    const words = [['drawing', [3, 55]]];
    const [nicknames, room_names] = {{ random_choices }};
  </script>
  <script src="{% static 'js/header.js' %}" type="text/javascript"></script>
  <script src="{% static 'js/lobby.js' %}" type="text/javascript"></script>
{% endblock %}
